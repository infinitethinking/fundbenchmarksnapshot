<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fund Performance Benchmark</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Outfit:wght@700&display=swap" rel="stylesheet">
  <style>
    body { background: #1A1230; font-family: 'Inter', sans-serif; color: #E0E7FF; }
    .glass-card {
      background: rgba(44, 26, 82, 0.4);
      border: 1px solid rgba(75, 45, 130, 0.6);
      border-radius: 16px;
      padding: 1.5rem;
      height: 100%;
      transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .glass-card:hover {
      transform: translateY(-2px);
      border-color: rgba(192, 168, 255, 0.8);
      box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
    }
    .text-light-purple { color: #C0A8FF; }
    .table-header { background: rgba(118, 77, 213, 0.2); font-weight: 600; color: #C0A8FF; }
    table { table-layout: fixed; }
    tbody tr { transition: background-color 0.15s ease; cursor: default; }
    tbody tr:hover { background-color: rgba(192, 168, 255, 0.1) !important; }

    .shared-1 { color: #5EEAD4; }
    .shared-2 { color: #F472B6; }
    .shared-3 { color: #FBBF24; }
    .shared-4 { color: #93C5FD; }
  </style>
</head>

<body class="p-8">
  <div class="max-w-6xl mx-auto space-y-8">
    <header class="text-center">
      <h1 class="text-5xl font-extrabold text-light-purple">Fund Benchmark Snapshot</h1>
      <p id="nav-date" class="mt-2 text-xl opacity-60"></p>
    </header>

    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-4 text-light-purple">INSIGHTS</h3>
      <div id="insights-s1" class="text-lg opacity-90 leading-relaxed font-normal"></div>
      <div class="border-t border-white/10 my-4"></div>
      <div id="insights-s2" class="text-lg opacity-90 leading-relaxed font-normal"></div>
    </div>

    <!-- Fund Directory -->
    <div class="glass-card">
      <table class="w-full text-left">
        <thead class="table-header"><tr><th class="p-2">Name</th><th class="p-2">ISIN</th><th class="p-2 text-right">AuM</th><th class="p-2 text-right">Factsheet</th></tr></thead>
        <tbody id="directory-body" class="divide-y divide-white/5"></tbody>
      </table>
    </div>

    <!-- Row 1 -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">Monthly Performance</h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">Return</th></tr></thead>
          <tbody id="monthly-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">Year-to-Date (YTD)</h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">Return</th></tr></thead>
          <tbody id="ytd-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Row 2 -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">
          Annualised Performance <span class="text-sm font-normal text-light-purple opacity-80">(since inception)</span>
        </h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">Return</th></tr></thead>
          <tbody id="annual-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">Volatility</h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">Vol.</th></tr></thead>
          <tbody id="vol-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Cash (bundled with cost of cash) -->
    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-2 text-light-purple">Cash</h3>
      <p class="text-xs opacity-60 mb-4">*Cost of cash assumes cash earns 0% over the period (cost = Cash% Ã— YTD return).</p>
      <table class="w-full text-left">
        <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">Cash</th><th class="p-2 text-right">Cost of cash*</th></tr></thead>
        <tbody id="cash-body" class="divide-y divide-white/5"></tbody>
      </table>
    </div>

    <!-- Row 3: TER left, WAD right -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">Total Expense Ratio (TER)</h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">TER</th></tr></thead>
          <tbody id="ter-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
      <div class="glass-card">
        <h3 class="text-xl font-semibold mb-4 text-light-purple">Weighted average duration</h3>
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2 text-right">WAD</th></tr></thead>
          <tbody id="wad-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Diversification -->
    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-4 text-light-purple">Diversification</h3>
      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead class="table-header"><tr><th class="p-2">Fund</th><th class="p-2">Investments</th><th class="p-2 text-right">Countries</th></tr></thead>
          <tbody id="div-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Top Region Allocation -->
    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-1 text-light-purple">Top Region Allocation</h3>
<p class="text-xs opacity-60 mb-4">Colours highlight regions that recur across managers.</p>
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead id="region-thead" class="table-header"></thead>
          <tbody id="region-tbody" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Top Country Allocation -->
    <div class="glass-card">
    <h3 class="text-xl font-semibold mb-1 text-light-purple">Top Country Allocation</h3>
<p class="text-xs opacity-60 mb-4">Colours highlight countries that recur across managers.</p>
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead id="country-thead" class="table-header"></thead>
          <tbody id="country-tbody" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Top Investees -->
    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-1 text-light-purple">Top Investees</h3>
<p class="text-xs opacity-60 mb-4">Colours highlight investees that recur across managers.</p>
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead id="investee-thead" class="table-header"></thead>
          <tbody id="investee-tbody" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <!-- Impact -->
    <div class="glass-card">
      <h3 class="text-xl font-semibold mb-4 text-light-purple">Impact Metrics</h3>
      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead id="impact-thead" class="table-header"></thead>
          <tbody id="impact-body" class="divide-y divide-white/5"></tbody>
        </table>
      </div>
    </div>

    <footer class="mt-12 text-[11px] opacity-60 text-center border-t border-white/10 pt-8 leading-relaxed">
      <p class="font-bold mb-2">Data disclaimer:</p>
      <p>The figures and information shown above are based exclusively on publicly available data. This page does not contain any confidential, proprietary, or non-public information. The content is provided for informational purposes only and does not constitute investment advice. Past performance is not indicative of future results.</p>
    </footer>
  </div>

  <script type="application/json" id="payload">
  {"nav_date":"31 December 2025","insights_s1":"Symbiotics ECF led monthly performance with a return of 0.89%, outperforming BlueOrchard by 33 bps.","insights_s2":"On a year-to-date basis, responsAbility recorded the highest return of 6.71%, leading Enabling by 28 bps.","directory":[{"manager":"BlueOrchard","name":"BlueOrchard Microfinance","isin":"LU0973079543","aum":"$3,198.7m","url":"https://www.blueorchard.com/wp-content/uploads/report/bomf/BOMF_I_EN.pdf"},{"manager":"Enabling","name":"EMF Microfinance Fund","isin":"LI0542527226","aum":"$726.7m","url":"https://enabling.ch/media/attachments/2026/01/16/emf_institutional_factsheet_december_25.pdf"},{"manager":"responsAbility","name":"responsAbility Micro and SME","isin":"n.a.","aum":"$621.7m","url":"https://www.responsability.com/products/monthly/2025_12_DFI_EN.pdf"},{"manager":"Symbiotics ECF","name":"Symbiotics Emerging Credit","isin":"LU1960396510","aum":"$55.2m","url":"https://symbiotics-am.com/wp-content/uploads/2026/01/LU-ECF-C-ACC-NH-USD-en-GB-2025-12-31.pdf"}],"tables":{"monthly":{"best_fund":"Symbiotics ECF","items":[{"fund":"Symbiotics ECF","value":"0.89%"},{"fund":"BlueOrchard","value":"0.56%"},{"fund":"Enabling","value":"0.49%"},{"fund":"responsAbility","value":"0.47%"}]},"ytd":{"best_fund":"responsAbility","items":[{"fund":"responsAbility","value":"6.71%"},{"fund":"Enabling","value":"6.43%"},{"fund":"BlueOrchard","value":"6.30%"},{"fund":"Symbiotics ECF","value":"6.19%"}]},"annual":{"best_fund":"Enabling","items":[{"fund":"Enabling","value":"6.15%"},{"fund":"responsAbility","value":"4.49%"},{"fund":"BlueOrchard","value":"4.41%"},{"fund":"Symbiotics ECF","value":"3.52%"}]},"vol":{"best_fund":"Enabling","items":[{"fund":"Enabling","value":"0.18%"},{"fund":"BlueOrchard","value":"0.49%"},{"fund":"responsAbility","value":"0.78%"},{"fund":"Symbiotics ECF","value":"0.88%"}]},"wad":{"items":[{"fund":"Symbiotics ECF","value":"23.5mo"},{"fund":"BlueOrchard","value":"25.7mo"},{"fund":"responsAbility","value":"26.4mo"},{"fund":"Enabling","value":"n.a."}]},"cash":{"items":[{"fund":"BlueOrchard","value":"3.00%"},{"fund":"responsAbility","value":"4.90%"},{"fund":"Enabling","value":"6.60%"},{"fund":"Symbiotics ECF","value":"8.90%"}]},"ter":{"items":[{"fund":"Symbiotics ECF","value":"0.96%"},{"fund":"responsAbility","value":"1.25%"},{"fund":"BlueOrchard","value":"1.34%"},{"fund":"Enabling","value":"n.a."}]},"div":{"items":[{"fund":"responsAbility","investments":"174","countries":"56"},{"fund":"BlueOrchard","investments":"160","countries":"51"},{"fund":"Enabling","investments":"142","countries":"48"},{"fund":"Symbiotics ECF","investments":"90","countries":"42"}]},"regions":{"funds":["BlueOrchard","Enabling","responsAbility","Symbiotics ECF"],"rows":[{"values":["Caucasus (16.63%)","South America (21.5%)","Central Asia (23.8%)","Latin America (34.0%)"],"group_ids":[null,2,1,null]},{"values":["Central Asia (13.77%)","Central Asia (19.1%)","Eastern Europe (15.5%)","Asia (27.2%)"],"group_ids":[1,1,null,null]},{"values":["East Asia and the Pacific (13.73%)","Central America (14.1%)","South America (12.3%)","Eurasia (25.4%)"],"group_ids":[null,null,2,null]}]},"top_country":{"funds":["BlueOrchard","Enabling","responsAbility","Symbiotics ECF"],"rows":[{"values":["India (10.3%)","Ecuador (n.a.)","India (9.6%)","India (9.3%)"],"group_ids":[1,null,1,1]},{"values":["Georgia (7.9%)","Mongolia (n.a.)","Turkey (6.7%)","Mexico (6.6%)"],"group_ids":[2,4,null,null]},{"values":["Uzbekistan (6.3%)","India (n.a.)","Georgia (6.7%)","Mongolia (5.6%)"],"group_ids":[3,1,2,4]},{"values":["Mongolia (4.6%)","Uzbekistan (n.a.)","Uzbekistan (5.8%)","Uzbekistan (5.1%)"],"group_ids":[4,3,3,3]},{"values":["Kazakhstan (4.2%)","Paraguay (n.a.)","Romania (5.6%)","Paraguay (5.1%)"],"group_ids":[null,5,null,5]}]},"investees":{"funds":["BlueOrchard","Enabling","responsAbility","Symbiotics ECF"],"rows":[{"values":["KMF BANK (2.95%)","Zeta Banco (3.00%)","Hamkor (2.6%)","Khan Bank, Mongolia (2.7%)"],"group_ids":[null,null,null,1]},{"values":["PROCREDIT HOLDING (2.91%)","CoopeAnde (2.00%)","Agricover (2.4%)","Banco Continental, Paraguay (2.7%)"],"group_ids":[null,null,2,null]},{"values":["KHAN BANK (2.49%)","Golomt Bank (2.00%)","Chongho (1.9%)","Ameriabank, Armenia (2.3%)"],"group_ids":[1,null,null,null]},{"values":["JSC CREDO BANK (2.35%)","Banco Bolivariano (2.00%)","IPAK YULI (1.9%)","AVLA Bermuda Holding, Bermuda (2.1%)"],"group_ids":[null,null,null,null]},{"values":["AGRICOVER CREDIT (2.12%)","UniBank (2.00%)","ArmeconomBank (1.7%)","Promerica CR, Costa Rica (2.1%)"],"group_ids":[2,null,null,null]}]},"impact":{"items":[{"fund":"BlueOrchard","borrowers":"1,029,663","loan":"$4,892","rural":"62.0%","women":"75.0%"},{"fund":"Enabling","borrowers":"17,488,518","loan":"$2,175","rural":"47.0%","women":"62.0%"},{"fund":"responsAbility","borrowers":"n.a.","loan":"n.a.","rural":"n.a.","women":"n.a."},{"fund":"Symbiotics ECF","borrowers":"38,706","loan":"$4,683","rural":"47.4%","women":"40.9%"}]}}}
  </script>

  <script>
  (function () {
    const HILITE = "text-teal-300 font-bold";
    const HILITE_TABLES = new Set(["monthly","ytd","annual","vol","wad","ter","cash"]);

    function parsePayload() {
      const el = document.getElementById("payload");
      if (!el) throw new Error("Missing #payload");
      return JSON.parse(el.textContent);
    }

    function setText(id, value) {
      const el = document.getElementById(id);
      if (!el) throw new Error("Missing #" + id);
      el.textContent = value ?? "";
    }

    function clear(el) { while (el.firstChild) el.removeChild(el.firstChild); }

    function mkTd(text, className, titleText) {
      const td = document.createElement("td");
      td.className = className;
      td.textContent = text ?? "";
      if (titleText) td.title = titleText;
      return td;
    }

    function pctVal(s) {
      const t = (s ?? "").trim();
      if (t === "" || t.toLowerCase() === "n.a.") return null;
      const m = t.match(/\(([-+]?\d+(\.\d+)?)%\)/);
      if (!m) return null;
      return parseFloat(m[1]);
    }

    function fmtPct1(x) {
      return (Math.round(x * 10) / 10).toFixed(1) + "%";
    }

    function parsePctValue(s) {
      const t = (s ?? "").trim();
      if (t === "" || t.toLowerCase() === "n.a.") return null;
      const m = t.match(/([-+]?\d+(\.\d+)?)%/);
      return m ? parseFloat(m[1]) : null;
    }

    function fmtBps1(x) {
      return (Math.round(x * 10) / 10).toFixed(1) + " bps";
    }

    function splitLabelPct(s) {
      const t = (s ?? "").trim();
      if (t === "" || t.toLowerCase() === "n.a.") return { label: "n.a.", pct: "" };
      const m = t.match(/^(.*)\s+\(([-+]?\d+(\.\d+)?)%\)\s*$/);
      if (!m) return { label: t, pct: "" };
      return { label: (m[1] ?? "").trim(), pct: (m[2] ?? "").trim() + "%" };
    }

    function mkTdShared2Line(text, className, groupId, titleText, lowerLabel) {
      const td = document.createElement("td");
      const g = (groupId === 1 || groupId === 2 || groupId === 3 || groupId === 4 || groupId === 5) ? (" shared-" + groupId) : "";
      td.className = className + g;

      const { label, pct } = splitLabelPct(text);
      const lab = lowerLabel ? (label ?? "").toLowerCase() : (label ?? "");
      const pctTxt = pct ?? "";

      const d1 = document.createElement("div");
      d1.className = "leading-tight";
      const l1 = document.createElement("div");
      l1.className = "truncate";
      l1.textContent = (lab ?? "").trim() === "" ? "n.a." : lab;
      const l2 = document.createElement("div");
      l2.className = "opacity-70 tabular-nums";
      l2.textContent = pctTxt;
      d1.appendChild(l1);
      d1.appendChild(l2);
      td.appendChild(d1);

      if (titleText) td.title = titleText;
      return td;
    }

    function managerFrom(it) {
      const m = (it?.manager ?? "").trim();
      return m && m.toLowerCase() !== "n.a." ? m : (it?.fund ?? "");
    }

    function renderTwoCol(tbodyId, items, bestFund, tableKey) {
      const tbody = document.getElementById(tbodyId);
      clear(tbody);
      (items || []).forEach((it, idx) => {
        const tr = document.createElement("tr");
        if (HILITE_TABLES.has(tableKey) && idx === 0) tr.className = HILITE;
        if (bestFund && it.fund === bestFund && HILITE_TABLES.has(tableKey)) {
          tr.className = tr.className ? (tr.className + " " + HILITE) : HILITE;
        }
        tr.appendChild(mkTd(managerFrom(it), "p-2 truncate whitespace-nowrap max-w-[18rem]", it.fund));
        tr.appendChild(mkTd(it.value, "p-2 text-right tabular-nums", it.value));
        tbody.appendChild(tr);
      });
    }

    function renderCashBundled(p) {
      const tbody = document.getElementById("cash-body");
      clear(tbody);

      const cashItems = p.tables?.cash?.items || [];
      const ytdItems  = p.tables?.ytd?.items  || [];

      const ytdMap = new Map();
      ytdItems.forEach(it => ytdMap.set(it.fund, it.value));

      cashItems.forEach((it, idx) => {
        const tr = document.createElement("tr");
        if (idx === 0) tr.className = HILITE;

        tr.appendChild(mkTd(managerFrom(it), "p-2 truncate whitespace-nowrap max-w-[18rem]", it.fund));
        tr.appendChild(mkTd(it.value ?? "n.a.", "p-2 text-right tabular-nums", it.value));

        const cashPct = parsePctValue(it.value);
        const ytdPct  = parsePctValue(ytdMap.get(it.fund));

        let out = "n.a.";
        if (cashPct != null && ytdPct != null) {
          const costBps = (cashPct / 100) * (ytdPct / 100) * 10000;
          out = fmtBps1(costBps);
        }

        tr.appendChild(mkTd(out, "p-2 text-right tabular-nums", out));
        tbody.appendChild(tr);
      });
    }

    function renderDiversification(items) {
      const tbody = document.getElementById("div-body");
      clear(tbody);
      (items || []).forEach(it => {
        const tr = document.createElement("tr");
        tr.appendChild(mkTd(managerFrom(it), "p-2 truncate whitespace-nowrap max-w-[18rem]", it.fund));
        tr.appendChild(mkTd(it.investments ?? "n.a.", "p-2 tabular-nums", it.investments ?? "n.a."));
        tr.appendChild(mkTd(it.countries ?? "n.a.", "p-2 text-right tabular-nums", it.countries ?? "n.a."));
        tbody.appendChild(tr);
      });
    }

    function renderDirectory(directory) {
      const tbody = document.getElementById("directory-body");
      clear(tbody);
      (directory || []).forEach(d => {
        const tr = document.createElement("tr");
        tr.appendChild(mkTd(d.name ?? "n.a.", "p-2 truncate whitespace-nowrap max-w-[18rem]", d.name));
        tr.appendChild(mkTd(d.isin ?? "n.a.", "p-2 opacity-60", d.isin));
        tr.appendChild(mkTd(d.aum ?? "n.a.", "p-2 text-right tabular-nums", d.aum));
        const td = document.createElement("td");
        td.className = "p-2 text-right";
        if (d.url && d.url !== "n.a.") {
          const a = document.createElement("a");
          a.href = d.url;
          a.textContent = "View";
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.className = "underline text-teal-300";
          td.appendChild(a);
        } else {
          td.textContent = "n.a.";
        }
        tr.appendChild(td);
        tbody.appendChild(tr);
      });
    }

    function renderTopRegionLike(theadId, tbodyId, block, managerMap, wantN, labelPrefix) {
      const thead = document.getElementById(theadId);
      const tbody = document.getElementById(tbodyId);
      clear(thead); clear(tbody);

      const funds = block?.funds || [];
      const rows = block?.rows || [];

      const useRows = [];
      for (let i = 0; i < wantN; i++) {
        useRows.push(rows[i] || { values: [], group_ids: [] });
      }

      const trh = document.createElement("tr");
      trh.appendChild(mkTd("", "p-2"));
      funds.forEach(f => {
        const mgr = managerMap.get(f) || f;
        trh.appendChild(mkTd(mgr, "p-2", f));
      });
      thead.appendChild(trh);

      const totals = funds.map((_, colIdx) => {
        let total = 0;
        let ok = false;
        useRows.forEach(r => {
          const v = (r.values || [])[colIdx] ?? "n.a.";
          const p = pctVal(v);
          if (p != null) { total += p; ok = true; }
        });
        return ok ? fmtPct1(total) : "n.a.";
      });

      useRows.forEach((r, rowIdx) => {
        const tr = document.createElement("tr");
        tr.appendChild(mkTd(labelPrefix + " " + (rowIdx + 1), "p-2 opacity-80"));

        const values = r.values || [];
        const gids = r.group_ids || [];
        funds.forEach((_, colIdx) => {
          const cell = values[colIdx] ?? "n.a.";
          tr.appendChild(mkTdShared2Line(cell, "p-2", gids[colIdx] ?? null, cell, false));
        });

        tbody.appendChild(tr);
      });

      const trTot = document.createElement("tr");
      trTot.appendChild(mkTd("Total", "p-2 font-semibold text-light-purple"));
      funds.forEach((_, colIdx) => {
        trTot.appendChild(mkTd(totals[colIdx], "p-2 tabular-nums font-semibold text-light-purple", totals[colIdx]));
      });
      tbody.appendChild(trTot);
    }

    function renderInvesteesAligned(matrix, managerMap) {
      const thead = document.getElementById("investee-thead");
      const tbody = document.getElementById("investee-tbody");
      clear(thead); clear(tbody);

      const funds = matrix?.funds || [];
      const rows = matrix?.rows || [];

      const trh = document.createElement("tr");
      trh.appendChild(mkTd("", "p-2"));
      funds.forEach(f => {
        const mgr = managerMap.get(f) || f;
        trh.appendChild(mkTd(mgr, "p-2", f));
      });
      thead.appendChild(trh);

      const wantN = 5;
      const useRows = [];
      for (let i = 0; i < wantN; i++) {
        useRows.push(rows[i] || { values: [], group_ids: [] });
      }

      const totals = funds.map((_, colIdx) => {
        let total = 0;
        let ok = false;
        useRows.forEach(r => {
          const v = (r.values || [])[colIdx] ?? "n.a.";
          const p = pctVal(v);
          if (p != null) { total += p; ok = true; }
        });
        return ok ? fmtPct1(total) : "n.a.";
      });

      useRows.forEach((r, rowIdx) => {
        const tr = document.createElement("tr");
        tr.appendChild(mkTd("Top Investee " + (rowIdx + 1), "p-2 opacity-80"));

        const values = r.values || [];
        const gids = r.group_ids || [];
        funds.forEach((_, colIdx) => {
          const cell = values[colIdx] ?? "n.a.";
          tr.appendChild(mkTdShared2Line(cell, "p-2", gids[colIdx] ?? null, cell, true));
        });

        tbody.appendChild(tr);
      });

      const trTot = document.createElement("tr");
      trTot.appendChild(mkTd("Total", "p-2 font-semibold text-light-purple"));
      funds.forEach((_, colIdx) => {
        trTot.appendChild(mkTd(totals[colIdx], "p-2 tabular-nums font-semibold text-light-purple", totals[colIdx]));
      });
      tbody.appendChild(trTot);
    }

    function renderImpact(items, managerMap) {
      const thead = document.getElementById("impact-thead");
      const tbody = document.getElementById("impact-body");
      clear(thead); clear(tbody);

      const funds = (items || []).map(it => it.fund ?? "n.a.");

      const trh = document.createElement("tr");
      trh.appendChild(mkTd("", "p-2"));
      funds.forEach(f => {
        const mgr = managerMap.get(f) || f;
        trh.appendChild(mkTd(mgr, "p-2", f));
      });
      thead.appendChild(trh);

      const rows = [
        { label: "Borrowers", key: "borrowers" },
        { label: "Loan",      key: "loan" },
        { label: "Rural %",   key: "rural" },
        { label: "Women %",   key: "women" }
      ];

      rows.forEach(r => {
        const tr = document.createElement("tr");
        tr.appendChild(mkTd(r.label, "p-2 opacity-80"));
        (items || []).forEach(it => {
          tr.appendChild(mkTd(it?.[r.key] ?? "n.a.", "p-2 tabular-nums", it?.[r.key] ?? "n.a."));
        });
        tbody.appendChild(tr);
      });
    }

    const p = parsePayload();

    const managerMap = new Map();
    (p.directory || []).forEach(d => {
      if (d?.name) {
        const m = (d.manager ?? "").trim();
        managerMap.set(d.name, (m && m.toLowerCase() !== "n.a.") ? m : d.name);
      }
    });

    setText("nav-date", p.nav_date || "");
    setText("insights-s1", p.insights_s1 || "");
    setText("insights-s2", p.insights_s2 || "");

    renderDirectory(p.directory || []);

    renderTwoCol("monthly-body", p.tables?.monthly?.items, p.tables?.monthly?.best_fund, "monthly");
    renderTwoCol("ytd-body",     p.tables?.ytd?.items,     p.tables?.ytd?.best_fund,     "ytd");
    renderTwoCol("annual-body",  p.tables?.annual?.items,  p.tables?.annual?.best_fund,  "annual");
    renderTwoCol("vol-body",     p.tables?.vol?.items,     p.tables?.vol?.best_fund,     "vol");
    renderTwoCol("ter-body",     p.tables?.ter?.items,     p.tables?.ter?.best_fund,     "ter");
    renderTwoCol("wad-body",     p.tables?.wad?.items,     p.tables?.wad?.best_fund,     "wad");

    renderCashBundled(p);
    renderDiversification(p.tables?.div?.items || []);

    renderTopRegionLike("region-thead", "region-tbody", p.tables?.regions || {}, managerMap, 3, "Top Region");
    renderTopRegionLike("country-thead", "country-tbody", p.tables?.top_country || {}, managerMap, 5, "Top Country");
    renderInvesteesAligned(p.tables?.investees || {}, managerMap);
    renderImpact(p.tables?.impact?.items || [], managerMap);
  })();
  </script>
</body>
</html>